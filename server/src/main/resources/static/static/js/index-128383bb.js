var se=Object.defineProperty;var N=Object.getOwnPropertySymbols;var ae=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable;var z=(o,e,t)=>e in o?se(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,T=(o,e)=>{for(var t in e||(e={}))ae.call(e,t)&&z(o,t,e[t]);if(N)for(var t of N(e))re.call(e,t)&&z(o,t,e[t]);return o};var L=(o,e,t)=>new Promise((c,r)=>{var s=n=>{try{l(t.next(n))}catch(w){r(w)}},u=n=>{try{l(t.throw(n))}catch(w){r(w)}},l=n=>n.done?c(n.value):Promise.resolve(n.value).then(s,u);l((t=t.apply(o,e)).next())});import{r as b,bf as ie,bg as le,f as C,H as ce,d as ue,a9 as V,A as de,bh as pe,G as fe,bi as _e,j as h,k as I,c as W,e as i,w as a,F,l as me,C as U,D as ve,b as we,t as k,n as E,aU as ye,R as ge,a5 as he,W as H,L as Se,bj as be,az as Ee,aA as R,aR as $,N as Ce,z as Pe}from"./index-9e787fa5.js";import{u as Te,P as Ie}from"./chartEditStore-56d3c83a.js";import{s as Re}from"./useSyncUpdate.hook-95de8bac.js";import{a as Oe}from"./project-c1868b8d.js";import{i as xe}from"./icon-caec1666.js";import"./plugin-e1dac962.js";import"./useSync.hook-87506693.js";import"./index-f6f97c94.js";import"./SettingItem-264e825b.js";/* empty css                                                                      */import"./SettingItemBox-ee4024ad.js";import"./CollapseItem.vue_vue_type_script_setup_true_lang-374cf080.js";import"./index.esm.min-33db7d4b.js";import"./fileTypeEnum-21359a08.js";import"./chartLayoutStore-58ece452.js";function Y(o){return ie()?(le(o),!0):!1}const O=typeof window!="undefined",Ae=o=>typeof o=="string",j=()=>{};function Le(o,e,t={}){const{immediate:c=!0}=t,r=b(!1);let s=null;function u(){s&&(clearTimeout(s),s=null)}function l(){r.value=!1,u()}function n(...w){u(),r.value=!0,s=setTimeout(()=>{r.value=!1,s=null,o(...w)},C(e))}return c&&(r.value=!0,O&&n()),Y(l),{isPending:r,start:n,stop:l}}const ke=O?window:void 0,He=O?window.navigator:void 0;function $e(...o){let e,t,c,r;if(Ae(o[0])?([t,c,r]=o,e=ke):[e,t,c,r]=o,!e)return j;let s=j;const u=ce(()=>C(e),n=>{s(),n&&(n.addEventListener(t,c,r),s=()=>{n.removeEventListener(t,c,r),s=j})},{immediate:!0,flush:"post"}),l=()=>{u(),s()};return Y(l),l}function je(o={}){const{navigator:e=He,read:t=!1,source:c,copiedDuring:r=1500}=o,s=["copy","cut"],u=!!(e&&"clipboard"in e),l=b(""),n=b(!1),w=Le(()=>n.value=!1,r);function S(){e.clipboard.readText().then(f=>{l.value=f})}if(u&&t)for(const f of s)$e(f,S);function p(){return L(this,arguments,function*(f=C(c)){u&&f!=null&&(yield e.clipboard.writeText(f),l.value=f,n.value=!0,w.start())})}return{isSupported:u,text:l,copied:n,copy:p}}const K=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},M="__vueuse_ssr_handlers__";K[M]=K[M]||{};var q,J;O&&(window!=null&&window.navigator)&&((q=window==null?void 0:window.navigator)!=null&&q.platform)&&/iP(ad|hone|od)/.test((J=window==null?void 0:window.navigator)==null?void 0:J.platform);var Be=Object.defineProperty,Q=Object.getOwnPropertySymbols,Ge=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,X=(o,e,t)=>e in o?Be(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,Ne=(o,e)=>{for(var t in e||(e={}))Ge.call(e,t)&&X(o,t,e[t]);if(Q)for(var t of Q(e))De.call(e,t)&&X(o,t,e[t]);return o};const ze={top:0,left:0,bottom:0,right:0,height:0,width:0};Ne({text:""},ze);const Ve=ue({__name:"index",setup(o){const{BrowsersOutlineIcon:e,SendIcon:t,AnalyticsIcon:c,CloseIcon:r}=xe.ionicons5,s=Te(),u=b(V()),{copy:l,isSupported:n}=je({source:u}),w=de(),S=b(!1),p=b(!1);pe(()=>{p.value=s.getProjectInfo.release||!1});const f=()=>{S.value=!1},Z=()=>{const d=Se(be.CHART_PREVIEW_NAME,"href");if(!d)return;const{id:_}=w.params,m=typeof _=="string"?_:_[0],y=s.getStorageInfo(),v=Ee(R.GO_CHART_STORAGE_LIST)||[];if(v!=null&&v.length){const P=v.findIndex(A=>A.id===m);P!==-1?(v.splice(P,1,T({id:m},y)),$(R.GO_CHART_STORAGE_LIST,v)):(v.push(T({id:m},y)),$(R.GO_CHART_STORAGE_LIST,v))}else $(R.GO_CHART_STORAGE_LIST,[T({id:m},y)]);Ce(d,[m],void 0,!0)},x=()=>{S.value=!S.value},B=(d,_)=>{n?(l(),window.$message.success(d||"复制成功！")):window.$message.error(_||"复制失败！")},ee=()=>L(this,null,function*(){const d=yield Oe({id:ye(),state:p.value?-1:1});d&&d.code===ge.SUCCESS?(x(),p.value?window.$message.success("已取消发布"):B("发布成功！已复制地址到剪贴板~","发布成功！"),s.setProjectInfo(Ie.RELEASE,!p.value)):he()}),G=[{select:!0,title:()=>"同步内容",type:()=>"primary",icon:H(c),event:Re},{key:"preview",title:()=>"预览",type:()=>"default",icon:H(e),event:Z},{key:"release",title:()=>p.value?"已发布":"发布",icon:H(t),type:()=>p.value?"primary":"default",event:x}],te=fe(()=>{if(s.getEditCanvas.isCodeEdit)return G;const d=_e.cloneDeep(G);return d.shift(),d});return(d,_)=>{const m=h("n-button"),y=h("n-space"),v=h("n-h3"),P=h("n-icon"),A=h("n-alert"),D=h("n-list-item"),oe=h("n-list"),ne=h("n-modal");return I(),W(F,null,[i(y,{class:"go-mt-0",wrap:!1},{default:a(()=>[(I(!0),W(F,null,me(te.value,g=>(I(),U(m,{key:g.key,type:g.type(),ghost:"",onClick:g.event},{icon:a(()=>[(I(),U(ve(g.icon)))]),default:a(()=>[we("span",null,k(g.title()),1)]),_:2},1032,["type","onClick"]))),128))]),_:1}),i(ne,{show:S.value,"onUpdate:show":_[1]||(_[1]=g=>S.value=g),onAfterLeave:f},{default:a(()=>[i(oe,{bordered:"",class:"go-system-setting"},{header:a(()=>[i(y,{justify:"space-between"},{default:a(()=>[i(v,{class:"go-mb-0"},{default:a(()=>[E("发布管理")]),_:1}),i(P,{size:"20",class:"go-cursor-pointer",onClick:f},{default:a(()=>[i(C(r))]),_:1})]),_:1})]),default:a(()=>[i(D,null,{default:a(()=>[i(y,{size:10},{default:a(()=>[i(A,{"show-icon":!1,title:"预览地址：",type:"success"},{default:a(()=>[E(k(C(V)()),1)]),_:1}),i(y,{vertical:""},{default:a(()=>[i(m,{tertiary:"",type:"primary",onClick:_[0]||(_[0]=g=>B())},{default:a(()=>[E(" 复制地址 ")]),_:1}),i(m,{type:p.value?"warning":"primary",onClick:ee},{default:a(()=>[E(k(p.value?"取消发布":"发布大屏"),1)]),_:1},8,["type"])]),_:1})]),_:1})]),_:1}),i(D,null,{default:a(()=>[i(y,{size:10},{default:a(()=>[i(m,{onClick:x},{default:a(()=>[E("关闭弹窗")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["show"])],64)}}});const at=Pe(Ve,[["__scopeId","data-v-62b97a1f"]]);export{at as default};
