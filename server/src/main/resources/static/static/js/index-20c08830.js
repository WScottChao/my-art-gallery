var ae=Object.defineProperty,ne=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var O=(r,e,l)=>e in r?ae(r,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):r[e]=l,$=(r,e)=>{for(var l in e||(e={}))le.call(e,l)&&O(r,l,e[l]);if(G)for(var l of G(e))se.call(e,l)&&O(r,l,e[l]);return r},M=(r,e)=>ne(r,oe(e));var R=(r,e,l)=>new Promise((g,_)=>{var d=a=>{try{h(l.next(a))}catch(s){_(s)}},p=a=>{try{h(l.throw(a))}catch(s){_(s)}},h=a=>a.done?g(a.value):Promise.resolve(a.value).then(d,p);h((l=l.apply(r,e)).next())});import{d as ie,E as re,G as E,a as C,I as ce,W as de,j as m,k as f,c as U,e as o,w as i,b,n as j,t as L,F as J,l as K,C as T,D as W,f as u,a6 as me,a7 as A,z as X,o as Y,af as V,aj as pe,ak as B,aa as Z,ad as ue,al as _e,V as k,am as z,an as fe,a8 as ge,a9 as ye,ao as he,Q as q,U as Q}from"./index-9e787fa5.js";import{i as ee}from"./icon-caec1666.js";import{f as be}from"./project-c1868b8d.js";import{p as xe,b as we}from"./product-f2aefb19.js";const ke={key:0,class:"go-items-list-card"},Te={class:"list-content"},ve={class:"list-content-top"},De={class:"list-content-img"},Pe={class:"go-flex-items-center list-footer",justify:"space-between"},Ie={class:"go-flex-items-center list-footer-ri"},Ne=ie({__name:"index",props:{cardData:Object},emits:["directory"],setup(r,{emit:e}){const l=re(),{DocumentTextIcon:g}=ee.ionicons5,_=e,d=E(()=>l.templateTypeMapping),p=(x="")=>x==""?"":l.getTemplateTypeInfo(x).label||"",h=r,a="http://127.0.0.1:8083",s=C([{label:ce("global.r_directory"),key:"directory",icon:de(g)}]),D=()=>{_("directory",h.cardData)};return(x,w)=>{const v=m("n-text"),P=m("n-image"),I=m("n-button"),t=m("n-tooltip"),c=m("n-space"),y=m("n-card");return r.cardData?(f(),U("div",ke,[o(y,{hoverable:"",size:"small"},{action:i(()=>[b("div",Pe,[o(v,{class:"go-ellipsis-1"},{default:i(()=>[j(L(r.cardData.templateName||r.cardData.id||"未命名"),1)]),_:1}),b("div",Ie,[o(c,null,{default:i(()=>[(f(!0),U(J,null,K(s,n=>(f(),T(t,{key:n.key,placement:"bottom",trigger:"hover"},{trigger:i(()=>[o(I,{size:"small",onClick:D},{icon:i(()=>[(f(),T(W(n.icon)))]),_:2},1024)]),default:i(()=>[(f(),T(W(n.label)))]),_:2},1024))),128))]),_:1})])])]),default:i(()=>[b("div",Te,[b("div",ve,[o(v,null,{default:i(()=>{var n,N;return[j(L(d.value[(n=r.cardData)==null?void 0:n.templateType])+"类型-"+L(p((N=r.cardData)==null?void 0:N.typeId)),1)]}),_:1})]),b("div",De,[o(P,{"object-fit":"contain",height:"180","preview-disabled":"",src:`${u(a)}/${r.cardData.indexImage}`,alt:r.cardData.templateName,"fallback-src":u(me)()},null,8,["src","alt","fallback-src"])])])]),_:1})])):A("",!0)}}});const ze=X(Ne,[["__scopeId","data-v-fc483954"]]);const Ce={class:"list-pagination"},Se={__name:"index",props:{show:{type:Boolean,default:()=>!1},info:{type:Object,default:()=>{}}},emits:["update:show"],setup(r,{emit:e}){const l=e,{CloseIcon:g}=ee.ionicons5,_=r,d=C({loading:!0,expandedRows:[],cycleList:[{label:"年",value:"year"},{label:"月",value:"month"},{label:"周",value:"week"},{label:"日",value:"day"},{label:"时",value:"hour"}],tableData:[],searchParam:{startTime:null,endTime:null,periodRange:null,state:1}}),p=C({page:1,limit:12,count:10}),h={year:"年",month:"月",week:"周",day:"日",hour:"时"};let a=E({get(){let{startTime:t,endTime:c}=d.searchParam;return!t&&!c?null:[t,c]},set(t){d.searchParam.startTime=(t==null?void 0:t[0])||null,d.searchParam.endTime=(t==null?void 0:t[1])||null}});Y(()=>{s()});const s=()=>R(this,null,function*(){d.loading=!0;let t=M($({},d.searchParam),{templateId:_.info.id,page:p.page,limit:p.limit});try{const c=yield xe(t);if((c==null?void 0:c.code)==200){d.tableData=c.data.map(n=>M($({},n),{templateName:_.info.templateName,key:n.id}));const{count:y}=c;p.count=y}setTimeout(()=>{d.loading=!1},500)}catch(c){d.loading=!1}}),D=(()=>[{type:"expand",renderExpand:t=>k(fe,{column:1,bordered:!0,labelPlacement:"left"},{default:()=>[k(z,{label:"名称"},{default:()=>t.taskName}),k(z,{label:"基于"},{default:()=>t.templateId}),k(z,{label:"周期"},{default:()=>`${t.period}${h[t.periodRange]}/次`}),k(z,{label:"时间"},{default:()=>t.createTime}),k(z,{label:"功能描述"},{default:()=>t.description||"暂无"})]})},{title:"任务",key:"id"},{title:"模板",key:"templateName"},{title:"创建时间",key:"createTime"},{title:"操作",key:"actions",width:200,render(t){return[{title:"可视化",type:"info",key:"visual",onClick:n=>{w(n)}},{title:"导出",type:"warning",key:"export",onClick:n=>{v(n)}}].map(n=>k(V,{size:"small",type:n.type,tertiary:!0,text:!0,style:{marginRight:"12px"},onClick:()=>n.onClick(t)},{default:()=>n.title}))}}])(),x=()=>{l("update:show",!1)},w=t=>{ge(ye(t.templateId))},v=t=>R(this,null,function*(){try{let{code:c,data:y}=yield be({templateId:t.templateId});c==200&&he(y.content,`${t.taskName}-${t.createTime}`,"json")}catch(c){window.$message.error("导出失败")}}),P=t=>{p.page=t,s()},I=t=>{p.limit=t,s()};return(t,c)=>{const y=m("n-date-picker"),n=m("n-spin"),N=m("n-pagination"),F=m("n-card"),te=m("n-modal");return f(),T(te,{show:_.show,"onUpdate:show":c[2]||(c[2]=S=>_.show=S)},{default:i(()=>{var S;return[o(F,{style:{width:"1000px"},title:`${(S=r.info)==null?void 0:S.templateName}-目录`,bordered:!1,size:"huge",role:"dialog","aria-modal":"true"},{"header-extra":i(()=>[o(u(V),{size:"small",text:"",onClick:x},{icon:i(()=>[o(u(g))]),_:1})]),footer:i(()=>[b("div",Ce,[o(N,{page:p.page,"page-size":p.limit,"item-count":p.count,"page-sizes":[12,24,36,48],"onUpdate:page":P,"onUpdate:pageSize":I,"show-size-picker":""},null,8,["page","page-size","item-count"])])]),default:i(()=>[o(u(pe),{ref:"formRef",inline:"","label-placement":"left","label-width":"auto"},{default:i(()=>[o(u(B),{label:"时间范围"},{default:i(()=>[o(y,{"formatted-value":u(a),"onUpdate:formattedValue":c[0]||(c[0]=H=>Z(a)?a.value=H:a=H),"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss",type:"datetimerange",clearable:""},null,8,["formatted-value"])]),_:1}),o(u(B),{label:"任务周期"},{default:i(()=>[o(u(ue),{value:d.searchParam.periodRange,"onUpdate:value":c[1]||(c[1]=H=>d.searchParam.periodRange=H),options:d.cycleList,style:{width:"250px"}},null,8,["value","options"])]),_:1}),o(u(B),null,{default:i(()=>[o(u(V),{ghost:"",onClick:s},{default:i(()=>[j(" 筛选 ")]),_:1})]),_:1})]),_:1},512),o(n,{show:d.loading},{default:i(()=>[d.loading?A("",!0):(f(),T(u(_e),{key:0,columns:u(D),data:d.tableData,"default-expand-all":""},null,8,["columns","data"]))]),_:1},8,["show"])]),_:1},8,["title"])]}),_:1},8,["show"])}}};const He={class:"go-project-statistical-productList-template"},$e={class:"list-pagination"},Me={__name:"index",setup(r){const e=C({currDirectory:{},directoryPanelShow:!1,loading:!0,tableData:[],searchParam:{name:null,startTime:null,endTime:null,state:1}}),l=C({page:1,limit:12,count:10});Y(()=>{g()});const g=()=>R(this,null,function*(){let a=M($({},e.searchParam),{page:l.page,limit:l.limit});try{const s=yield we(a);(s==null?void 0:s.code)==200&&(e.tableData=s.data),setTimeout(()=>{e.loading=!1},1e3*1.5)}catch(s){e.loading=!1}}),_=a=>{l.page=a,g()},d=a=>{l.limit=a,g()};let p=E({get(){let{startTime:a,endTime:s}=e.searchParam;return!a&&!s?null:[a,s]},set(a){e.searchParam.startTime=(a==null?void 0:a[0])||null,e.searchParam.endTime=(a==null?void 0:a[1])||null}});const h=a=>{e.currDirectory=a,e.directoryPanelShow=!0};return(a,s)=>{const D=m("go-loading"),x=m("n-input"),w=m("n-form-item"),v=m("n-date-picker"),P=m("n-button"),I=m("n-form"),t=m("n-grid-item"),c=m("n-grid"),y=m("n-pagination");return f(),U("div",He,[q(b("div",null,[o(D)],512),[[Q,e.loading]]),q(b("div",null,[o(I,{ref:"formRef",inline:"","label-placement":"left","label-width":"auto"},{default:i(()=>[o(w,{label:"产品名称"},{default:i(()=>[o(x,{placeholder:"请输入",value:e.searchParam.name,"onUpdate:value":s[0]||(s[0]=n=>e.searchParam.name=n)},null,8,["value"])]),_:1}),o(w,{label:"创建时间"},{default:i(()=>[o(v,{"formatted-value":u(p),"onUpdate:formattedValue":s[1]||(s[1]=n=>Z(p)?p.value=n:p=n),"value-format":"yyyy-MM-dd HH:mm:ss",format:"yyyy-MM-dd HH:mm:ss",type:"datetimerange",clearable:""},null,8,["formatted-value"])]),_:1}),o(w,null,{default:i(()=>[o(P,{ghost:"",onClick:g},{default:i(()=>[j(" 筛选 ")]),_:1})]),_:1})]),_:1},512),o(c,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:4 xl:4 xxl:4",responsive:"screen"},{default:i(()=>[(f(!0),U(J,null,K(e.tableData,(n,N)=>(f(),T(t,{key:n.id},{default:i(()=>[o(ze,{cardData:n,onDirectory:F=>h(n)},null,8,["cardData","onDirectory"])]),_:2},1024))),128))]),_:1})],512),[[Q,!e.loading]]),b("div",$e,[o(y,{page:l.page,"page-size":l.limit,"item-count":l.count,"page-sizes":[12,24,36,48],"onUpdate:page":_,"onUpdate:pageSize":d,"show-size-picker":""},null,8,["page","page-size","item-count"])]),e.directoryPanelShow?(f(),T(Se,{key:0,show:e.directoryPanelShow,"onUpdate:show":s[2]||(s[2]=n=>e.directoryPanelShow=n),info:e.currDirectory},null,8,["show","info"])):A("",!0)])}}},Be=X(Me,[["__scopeId","data-v-2333bc56"]]);export{Be as default};
